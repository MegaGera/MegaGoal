<div class="container">

  <!-- Hero Section -->
  <app-hero-section [userStats]="userStats" [userStatsLoaded]="userStatsLoaded"></app-hero-section>

  <!-- View Toggle -->
  <div class="row">
    <div class="col-12">
      <div class="view-toggle-card">
        <div class="view-toggle">
          <button class="toggle-btn" [class.active]="viewMode === 'stats'" (click)="setView('stats')">Stats</button>
          <button class="toggle-btn" [class.active]="viewMode === 'matches'" (click)="setView('matches')">Matches</button>
          <button class="toggle-btn" [class.active]="viewMode === 'filters'" (click)="setView('filters')">Filters</button>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-content row m-auto" id="nav-tabContent">
    <div class="tab-pane col-md-3 col-12" 
         [class.show]="viewMode === 'stats'"
         [class.d-md-block]="true"
         id="nav-stats" 
         role="tabpanel">
      
      <!-- Left column: Stats information column -->
      @if (this.matchesLoaded && this.matchesOriginal.length > 0) {
        @if (this.matches.length > 0) {
          <!-- Favourite Team Card -->
          <app-favourite-team-card 
            [teamStats]="favouriteTeamStats" 
            [isLoading]="!favouriteTeamLoaded"
            [showAllStatsOnMobile]="true">
          </app-favourite-team-card>

          <!-- General Stats Component -->
          <app-general-stats 
            [generalStats]="generalStats" 
            [generalStatsLoaded]="generalStatsLoaded">
          </app-general-stats>
        } @else {
          <!-- No results message for stats column -->
          <div class="no-stats-container">
            <div class="no-stats-card">
              <div class="no-stats-icon">
                <ng-icon name="jamFilterF" size="3rem" class="filter-icon"></ng-icon>
              </div>
              <h3 class="no-stats-title">No stats available</h3>
              <p class="no-stats-description">
                No matches found with current filters. Try adjusting your selection to see statistics.
              </p>
            </div>
          </div>
        }
      }

    </div>
    <div class="tab-pane col-md-6 col-12" 
         [class.show]="viewMode === 'matches'"
         [class.d-md-block]="true"
         id="nav-matches" 
         role="tabpanel">
      
      <!-- Center column: Matches -->
      @if (this.matchesLoaded && this.matches.length > 0) {
                  <!-- Matches Header -->
          <div class="matches-header">
            <h3 class="matches-title">{{ matches.length }} matches</h3>
          </div>

        <!-- Iterate the matches filtered array -->
        @for (match of matchesFiltered; track $index) {
          <div class="matchCardAdapter">
            <app-real-match-card [match]="match" [watched]="true" [locations]="locations" />
          </div>
        }

        <!-- Pagination -->
        <div class="paginationDiv">
          <app-pagination [elements]="this.matches" [elementsPerPage]="10" [(elementsFiltered)]="this.matchesFiltered" />
        </div>
      } @else if (this.matchesLoaded && this.matches.length == 0) {
        <div class="no-matches-container">
          <div class="no-matches-card">
            <div class="no-matches-icon">
              <ng-icon name="ionFootball" size="4rem" class="football-icon"></ng-icon>
            </div>
            <h2 class="no-matches-title">No matches found</h2>
            <p class="no-matches-description">
              Try adjusting your filters or add more matches!
            </p>
            <div class="no-matches-actions">
              <button class="reset-filters-btn" (click)="resetFilters()">
                <ng-icon name="jamFilterF"></ng-icon>
                Reset Filters
              </button>
            </div>
          </div>
        </div>
      } @else if (!this.matchesLoaded) {
        <div class="spinner">
          <mat-spinner />
        </div>
      }

    </div>
    <div class="tab-pane col-md-3 col-12" 
         [class.show]="viewMode === 'filters'"
         [class.d-md-block]="true"
         id="nav-filters" 
         role="tabpanel">
      
      <!-- Filters Component -->
      @if (this.matchesLoaded && this.matchesOriginal.length > 0) {
        <app-filters-home
          [filterPanelChipSelected]="filterPanelChipSelected"
          [filterLeagueSelected]="filterLeagueSelected"
          [filterSeasonSelected]="filterSeasonSelected"
          [filterLocationSelected]="filterLocationSelected"
          [seasons]="seasonsFiltered"
          [locations]="locationsFiltered"
          [leaguesViewed]="leaguesFiltered"
          [leaguesLoaded]="leaguesLoaded"
          (filterPanelChipSelectedChange)="changeFilterPanelChipSelected($event)"
          (filterLeagueSelectedChange)="changeFilterLeagueSelected($event)"
          (filterSeasonSelectedChange)="changeFilterSeasonSelected($event)"
          (filterLocationSelectedChange)="changeFilterLocationSelected($event)"
          (resetFiltersChange)="resetFilters()">
        </app-filters-home>
      }
    </div>
  </div>

</div>