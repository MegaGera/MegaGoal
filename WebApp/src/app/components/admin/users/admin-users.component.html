<div class="admin-users-container">
  <section class="fade-in">
    <div class="admin-header-row">
      <h1 class="section-title">Users Match Statistics</h1>
    </div>
    <p class="section-description">View the number of matches marked as viewed by each user</p>

    @if (loading && usersList.length === 0) {
      <div class="text-center loading-container">
        <div class="spinner-border spinner-border-lg" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3">Loading users statistics...</p>
      </div>
    } @else if (error) {
      <div class="alert alert-danger" role="alert">
        {{ error }}
        <button class="btn btn-sm btn-outline-danger ms-2" (click)="loadUsersMatchCounts()">Retry</button>
      </div>
    } @else if (usersList.length === 0) {
      <div class="empty-state">
        <p class="empty-message">No users found.</p>
      </div>
    } @else {
      <div class="users-stats">
        <div class="stat-card">
          <div class="stat-value">{{ totalUsers }}</div>
          <div class="stat-label">Total Users</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">{{ totalMatches }}</div>
          <div class="stat-label">Total Matches Viewed</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">{{ averageMatchesPerUser }}</div>
          <div class="stat-label">Average Matches per User</div>
        </div>
      </div>

      <div class="users-list">
        <div class="users-table-header">
          <div class="table-header-cell rank-cell">Rank</div>
          <div class="table-header-cell username-cell">Username</div>
          <div class="table-header-cell count-cell">Matches Viewed</div>
        </div>
        @for (user of usersList; track user.username; let i = $index) {
          <div class="user-row">
            <div class="table-cell rank-cell">
              <span class="rank-badge" [class.top-three]="i < 3">{{ i + 1 }}</span>
            </div>
            <div class="table-cell username-cell">
              <span class="username">{{ user.username }}</span>
            </div>
            <div class="table-cell count-cell">
              <span class="match-count">{{ user.matchCount }}</span>
            </div>
          </div>
        }
      </div>
    }
  </section>
</div>

